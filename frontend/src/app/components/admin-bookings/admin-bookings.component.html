<div class="container py-3">
  <h2 class="mb-3">All Bookings</h2>
  
  <!-- Loading State -->
  <div *ngIf="isLoading" class="text-center py-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading bookings...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="alert alert-danger" role="alert">
    <strong>Error:</strong> {{ error }}
    <div *ngIf="error.includes('Hibernate lazy loading')" class="mt-2">
      <small class="text-muted">
        This is a backend configuration issue. The administrator needs to fix the Hibernate lazy loading configuration in the Spring Boot application.
      </small>
    </div>
    <button class="btn btn-sm btn-outline-danger ms-2" (click)="loadBookings()">Retry</button>
  </div>

  <!-- No Bookings State -->
  <div *ngIf="!isLoading && !error && bookings.length === 0" class="alert alert-info" role="alert">
    No bookings found. When users make bookings, they will appear here.
  </div>

  <!-- Bookings Table -->
  <div *ngIf="!isLoading && !error && bookings.length > 0" class="table-responsive">
    <table class="table table-striped table-bordered align-middle">
      <thead class="table-light">
        <tr>
          <th>ID</th>
          <th>Hall ID</th>
          <th>Customer</th>
          <th>Start Date</th>
          <th>End Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let b of bookings">
          <td>{{ b.id }}</td>
          <td>{{ b.hall.id || 'N/A' }}</td>
          <td>{{ b.customerName }}</td>
          <td>{{ b.startDate | date:'shortDate' }}</td>
          <td>{{ b.endDate | date:'shortDate' }}</td>
          <td>
            <span class="badge" [ngClass]="{
              'bg-success': b.status === 'CONFIRMED',
              'bg-warning': b.status === 'PENDING',
              'bg-danger': b.status === 'CANCELLED'
            }">
              {{ b.status || 'N/A' }}
            </span>
          </td>
          <td>
            <button class="btn btn-sm btn-danger" (click)="deleteBooking(b.id!)">
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Refresh Button -->
  <div class="mt-3">
    <button class="btn btn-primary" (click)="loadBookings()" [disabled]="isLoading">
      <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-1"></span>
      Refresh Bookings
    </button>
  </div>
</div>


